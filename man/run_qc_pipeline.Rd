% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wrapper.R
\name{run_qc_pipeline}
\alias{run_qc_pipeline}
\title{High-level wrapper that computes QC metrics, flags low-quality cells,
(optionally) detects doublets and performs lightweight annotation, and
renders an HTML report.}
\usage{
run_qc_pipeline(
  obj,
  species = c("mouse", "human"),
  method = c("gmm", "threshold", "auto"),
  score_cutoff = 2,
  auto_k = 3,
  assay = "RNA",
  save_dir = "qc_outputs",
  report_file = "qc_report.html",
  spliced = NULL,
  unspliced = NULL,
  spliced_obj = NULL,
  spliced_assay = NULL,
  spliced_layer = "counts",
  unspliced_obj = NULL,
  unspliced_assay = NULL,
  unspliced_layer = "counts",
  doublets = c("none", "auto", "doubletfinder", "scdblfinder"),
  remove_doublets = TRUE,
  sample_col = NULL,
  annot_method = c("marker_score", "singleR", "sctype", "none"),
  marker_source = c("panglao", "internal", "custom"),
  panglao_file = NULL,
  canonical_only = TRUE,
  ui_max = 0.2,
  tissue = NULL,
  min_genes = 5,
  report_html = TRUE,
  theme_bootswatch = "minty",
  debug = FALSE,
  sctype_db_path = system.file("extdata", "ScTypeDB_full.xlsx", package = "scQCenrich",
    mustWork = FALSE),
  marker_method = c("findmarkers", "module_score"),
  annot_args = NULL,
  unknown_min_genes = 2,
  unknown_min_margin = 0.01,
  unknown_min_top = 0.01,
  qc_strength = c("auto", "default", "lenient", "strict"),
  enrichment_plots = T
)
}
\arguments{
\item{obj}{Seurat object}

\item{species}{'mouse' or 'human'}

\item{method}{'threshold', 'gmm' or 'auto'}

\item{score_cutoff}{Integer cutoff used by 'threshold' mode}

\item{auto_k}{Ignored; kept for back-compat}

\item{assay}{Assay name}

\item{save_dir}{Directory for intermediate outputs}

\item{report_file}{Output HTML report path}

\item{spliced, unspliced}{Back-compat layer strings on the same object}

\item{spliced_obj, unspliced_obj}{Optional external Seurat objects}

\item{spliced_assay, unspliced_assay}{Assay names on external objects}

\item{spliced_layer, unspliced_layer}{Layer/slot on external objects}

\item{doublets}{'auto','doubletfinder','scdblfinder','none'}

\item{remove_doublets}{Logical; if TRUE, mark doublets to remove/borderline}

\item{sample_col}{Optional meta column with sample/group}

\item{annot_method}{'SingleR','marker_score','none'}

\item{marker_source}{'panglao','internal','custom' (only used when annot_method='marker_score')}

\item{panglao_file}{Optional path to Panglao TSV (defaults to inst/extdata if present)}

\item{canonical_only, ui_max, min_genes}{Panglao signature filtering knobs}

\item{tissue}{Character vector of target organs/tissues, e.g. c("Liver","Kidney").}

\item{report_html}{Logical; if TRUE, render the report}

\item{theme_bootswatch}{Bootswatch theme for report}

\item{debug}{Logical for verbose messages}

\item{sctype_db_path}{Path to ScType Excel DB. Defaults to the packaged file}

\item{marker_method}{Either "module_score" (default) or "findmarkers".}

\item{annot_args}{List of extra args forwarded to \code{auto_annotate()}.}

\item{unknown_min_genes}{Integer; guard for "unknown" assignment.}

\item{unknown_min_margin}{Numeric; guard for "unknown" assignment.}

\item{unknown_min_top}{Integer; guard for "unknown" assignment.}

\item{qc_strength}{One of \code{c("lenient","moderate","strict")}; passed to \code{flagLowQuality()}.}

\item{enrichment_plots}{logical. If TRUE, run GO/KEGG enrichment plots; if FALSE, skip. Default: TRUE.}
}
\value{
A list with at least: \code{$obj} (QC-kept), \code{$metrics}, \code{$status_df}, \code{$report_file}.
Also returns \code{$obj_all} for convenience.
}
\description{
High-level wrapper that computes QC metrics, flags low-quality cells,
(optionally) detects doublets and performs lightweight annotation, and
renders an HTML report.
}
