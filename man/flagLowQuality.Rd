% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter.R
\name{flagLowQuality}
\alias{flagLowQuality}
\title{Flag low-quality cells}
\usage{
flagLowQuality(
  metrics,
  method = c("threshold", "gmm", "hdbscan"),
  score_cutoff = 2,
  auto_k = 3,
  obj = NULL,
  celltype_col = NULL,
  sample_col = NULL,
  rescue_mode = c("moderate", "conservative", "aggressive"),
  min_cluster_size = NULL,
  doublet_action = c("remove", "borderline", "none"),
  doublet_col = "is_doublet",
  qc_strength = c("auto", "default", "lenient", "strict"),
  save_dir = NULL
)
}
\arguments{
\item{metrics}{data.frame of QC metrics (rows=cells). If it contains a logical
column 'is_doublet' (as added by calcQCmetrics), it will be honored.}

\item{method}{"threshold", "gmm", or "hdbscan"}

\item{score_cutoff}{integer for threshold mode (default 2)}

\item{auto_k}{kept for API compat (unused here)}

\item{obj}{optional Seurat object for rescue step}

\item{celltype_col}{optional meta column for rescue label coherence}

\item{sample_col}{optional sample column (passed to detector; may be NULL)}

\item{rescue_mode}{"moderate","conservative","aggressive"}

\item{min_cluster_size}{minimum cluster size to consider for rescue; NULL = adaptive (~0.5\% or >=10)}

\item{doublet_action}{what to do with predicted doublets in \code{metrics$is_doublet}:
"remove" (default), "borderline", or "none"}

\item{doublet_col}{name of the doublet flag column in \code{metrics} (default "is_doublet")}

\item{qc_strength}{One of c("auto","default","lenient","strict")}

\item{save_dir}{Character path or NULL. If non-NULL, write intermediate CSVs here.}
}
\value{
data.frame with rownames=cells and columns: qc_status, qc_score, cluster, reason,
}
\description{
Flag low-quality cells
}
